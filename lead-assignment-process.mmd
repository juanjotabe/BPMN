# Sistema de GestiÃ³n y AsignaciÃ³n de Leads

Sistema automatizado de asignaciÃ³n de leads basado en competencias, con Quality Gates y lÃ³gica de matching flexible.

## ðŸ“Š Diagrama (estilo BPMN) del Proceso

```mermaid
flowchart TB
  Start([Lead Recibido]) --> Intake[Ingesta de Datos]

  Intake --> QG1{"Quality Gate<br/>Campos obligatorios<br/>Â¿completos?"}

  QG1 -->|No| Reject1[Rechazar lead]
  Reject1 --> NotifySource["Notificar fuente<br/>Datos faltantes"]
  NotifySource --> End1([Fin Â· Lead rechazado])

  QG1 -->|SÃ­| Validate["ValidaciÃ³n estructural<br/>y semÃ¡ntica"]
  Validate --> QG2{"Â¿Datos vÃ¡lidos<br/>y coherentes?"}

  QG2 -->|No| ManualQ[Cola de revisiÃ³n manual]
  ManualQ --> HumanReview[RevisiÃ³n humana]
  HumanReview --> QG2B{"Â¿Datos corregidos?"}
  QG2B -->|No| End2([Fin Â· Lead descartado])
  QG2B -->|SÃ­| Normalize

  QG2 -->|SÃ­| Normalize["NormalizaciÃ³n<br/>y estandarizaciÃ³n"]
  Normalize --> Enrich["Enriquecimiento<br/>datos externos"]
  Enrich --> QualityScore["Calcular<br/>Quality Score"]

  QualityScore --> QG3{"Quality Score<br/>â‰¥ 70%?"}

  QG3 -->|No| LowQuality["Marcar como<br/>baja calidad"]
  LowQuality --> Classify

  QG3 -->|SÃ­| Classify[ClasificaciÃ³n de lead]
  Classify --> DetermineType["Determinar tipo:<br/>Premium/EstÃ¡ndar/Baja cal."]
  DetermineType --> ImpactMatrix[Matriz impacto-urgencia]
  ImpactMatrix --> AssignPriority["Asignar prioridad<br/>P1/P2/P3/P4"]
  AssignPriority --> CalcReq["Calcular requerimientos<br/>de competencias"]
  CalcReq --> QueryConsultants["Consultar disponibilidad<br/>de consultores"]

  QueryConsultants --> FilterTeams{"Filtrar por<br/>equipos permitidos"}
  FilterTeams --> MatchEngine["Motor de matching<br/>calcular scores"]
  MatchEngine --> CheckMatch{"Â¿Existe match<br/>score â‰¥ umbral?"}

  CheckMatch -->|No| Fallback{"Â¿Prioridad = P1?"}
  Fallback -->|SÃ­| Escalate["Escalar a manager<br/>asignaciÃ³n manual"]
  Escalate --> ManualAssign[AsignaciÃ³n manual]
  ManualAssign --> RegisterCRM

  Fallback -->|No| WaitQueue["AÃ±adir a cola<br/>de espera"]
  WaitQueue --> CheckAvail{"Revisar cada 5 min<br/>Â¿consultor disponible?"}
  CheckAvail -->|No Â· Timeout| EscalateTimeout["Escalar por<br/>timeout SLA"]
  EscalateTimeout --> Escalate
  CheckAvail -->|SÃ­| MatchEngine

  CheckMatch -->|SÃ­| ValidateCapacity{"Â¿Consultor tiene<br/>capacidad?"}
  ValidateCapacity -->|No Â· P1| OverrideCapacity["Override capacidad<br/>por prioridad crÃ­tica"]
  OverrideCapacity --> Assign

  ValidateCapacity -->|No Â· no-P1| NextBestMatch["Siguiente mejor<br/>match"]
  NextBestMatch --> CheckMatch

  ValidateCapacity -->|SÃ­| Assign["Asignar lead<br/>a consultor"]

  Assign --> RegisterCRM[Registrar en CRM]
  RegisterCRM --> NotifyConsultant["Notificar<br/>consultor"]
  NotifyConsultant --> StartSLA["Iniciar tracking<br/>SLA"]

  StartSLA --> UpdateMetrics["Actualizar<br/>mÃ©tricas"]
  UpdateMetrics --> LogHistory["Registrar en<br/>historial"]

  LogHistory --> MonitorLoop{"Monitoreo<br/>continuo"}
  MonitorLoop --> CheckSLA["Verificar<br/>cumplimiento SLA"]
  CheckSLA --> CheckStatus{"Â¿Lead atendido?"}

  CheckStatus -->|No Â· SLA breach| AlertSLA["Alerta<br/>incumplimiento SLA"]
  AlertSLA --> MonitorLoop

  CheckStatus -->|No Â· Dentro SLA| MonitorLoop

  CheckStatus -->|SÃ­| RecordOutcome["Registrar resultado<br/>conversiÃ³n/descarte"]
  RecordOutcome --> UpdateCompetency["Actualizar histÃ³rico<br/>performance consultor"]
  UpdateCompetency --> FinalMetrics["Actualizar<br/>mÃ©tricas finales"]
  FinalMetrics --> End3([Fin Â· Lead procesado])

  %% Styles
  style Start fill:#e1f5e1
  style End1 fill:#ffe1e1
  style End2 fill:#ffe1e1
  style End3 fill:#e1f5e1
  style QG1 fill:#fff4e1
  style QG2 fill:#fff4e1
  style QG3 fill:#fff4e1
  style CheckMatch fill:#e1f0ff
  style Fallback fill:#ffe1f0
  style ValidateCapacity fill:#e1f0ff
  style Assign fill:#d4edda
  style Escalate fill:#f8d7da
  style WaitQueue fill:#fff3cd
